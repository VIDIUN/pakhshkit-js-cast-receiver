{"version":3,"sources":["./cast/receiver/webpack/universalModuleDefinition","./cast/receiver/playkit-cast-receiver.js","./cast/receiver/webpack/bootstrap b67bb6a51662b0697f67","./cast/receiver/external {\"commonjs\":\"kaltura-player-js\",\"commonjs2\":\"kaltura-player-js\",\"amd\":\"kaltura-player-js\",\"root\":[\"KalturaPlayer\"]}","./cast/receiver/./receiver-manager.js","./cast/receiver/./player-loader.js","./cast/receiver/./index.js","./cast/receiver/./receiver-manager-api.js","./cast/receiver/./cast-engine.js","./cast/receiver/./default-player-config.js","./cast/receiver/./error/error.js","./cast/receiver/./error/error-type.js","./cast/receiver/./receiver-tracks-manager.js","./cast/receiver/./receiver-ads-manager.js"],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE_0__","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_defineProperty","obj","key","value","writable","_classCallCheck","instance","Constructor","TypeError","ReceiverManager","CUSTOM_CHANNEL","undefined","_createClass","defineProperties","target","props","length","descriptor","protoProps","staticProps","_kalturaPlayerJs","_playerLoader","_receiverTracksManager","_receiverAdsManager","EventManager","core","FakeEvent","DrmScheme","Utils","getLogger","CustomMessageType","cast","CustomActionType","CustomActionMessage","config","_messageInterceptorsH","_playerManagerEventHa","_logger","_shouldAutoPlay","_firstPlay","_messageInterceptorsHandlers","framework","messages","MessageType","LOAD","onLoad","MEDIA_STATUS","onMediaStatus","STOP","onStop","_playerManagerEventHandlers","events","EventType","REQUEST_PLAY","_onRequestPlayEvent","REQUEST_PAUSE","_onRequestPauseEvent","PLAY","_onPlayEvent","PLAYER_LOAD_COMPLETE","_onPlayerLoadCompleteEvent","_castContextEventHandlers","system","SYSTEM_VOLUME_CHANGED","_onSystemVolumeChangedEvent","_context","CastReceiverContext","getInstance","_playerManager","getPlayerManager","_eventManager","_player","PlayerLoader","loadPlayer","_tracksManager","ReceiverTracksManager","_adsManager","ReceiverAdsManager","_attachListeners","options","defaultOptions","CastReceiverOptions","customNamespaces","JSON","mergeDeep","debug","start","loadRequestData","_this","_reset","Promise","resovle","reject","mediaInfo","media","customData","_maybeCreateVmapAdsRequest","_maybeReplaceAdTagTimestamp","listen","Event","ERROR","event","SOURCE_SELECTED","_onSourceSelected","loadMedia","requestData","_destroy","mediaStatus","getMediaInfo","isLive","currentTime","duration","playerState","getPlayerState","_this2","addCustomMessageListener","customMessage","_onCustomMessage","keys","forEach","addEventListener","bind","msg","setMessageInterceptor","removeAll","reset","destroy","resolve","source","payload","selectedSource","_handleAutoPlay","_handleLiveDvr","_setMediaInfo","_maybeSetDrmLicenseUrl","contentId","id","contentUrl","url","contentType","mimetype","streamType","StreamType","LIVE","BUFFERED","metadata","GenericMediaMetadata","title","sources","subtitle","description","images","poster","hlsSegmentFormat","HlsSegmentFormat","TS","autoplay","isDvr","removeSupportedMediaCommands","Command","SEEK","addSupportedMediaCommands","_this3","drmData","data","find","scheme","WIDEVINE","setMediaPlaybackInfoHandler","loadRequest","playbackConfig","protectionSystem","ContentProtection","licenseUrl","firstPlay","play","pause","_this4","load","ready","then","setInitialTracks","systemVolumeChangedEvent","volume","level","muted","customMessageEvent","type","ACTION","_handleCustomAction","customAction","action","SKIP_AD","skipAd","vmapAdsRequest","replaceTimestamp","adtag","regex","test","match","replace","Date","now","breakClips","breakClip","vastAdsRequest","adTagUrl","CAST_MEDIA_PLAYER_TAG","_castEngine","_defaultPlayerConfig","_error","_errorType","unRegisterEngine","registerEngine","EngineType","castMediaPlayerEl","Dom","getElementsByTagName","castMediaElement","getMediaElement","style","position","playerContainerEl","createElement","appendChild","document","body","HTML5","CAST","CastEngine","playerConfig","targetId","DefaultPlayerConfig","player","setup","prependTo","parentNode","ReceiverError","ErrorType","CAST_ELEMENT_NOT_FOUND","NAME","VERSION","Receiver","_receiverManagerApi","ReceiverManagerAPI","_receiverManager","receiverManager","arguments","listener","getPlayer","removeEventListener","_toConsumableArray","arr","Array","isArray","arr2","from","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","Track","MediaType","FakeEventTarget","AudioTrack","TextTrack","AbrMode","MimeType","_FakeEventTarget","getPrototypeOf","_isLoaded","_tracks","_volume","_muted","_paused","_seeking","_ended","_mediaElementEvents","ABORT","CAN_PLAY","CAN_PLAY_THROUGH","DURATION_CHANGE","EMPTIED","ENDED","LOADED_DATA","LOADED_METADATA","LOAD_START","PAUSE","PLAYING","PROGRESS","RATE_CHANGE","SEEKED","SEEKING","STALLED","TIME_UPDATE","SUSPEND","WAITING","_createVideoElement","_init","mimeType","toLowerCase","_supportedMimeTypes","includes","DASH","videoElement","getVideoElement","dispatchEvent","broadcastStatus","mediaElementEvent","_el","startTime","_parseTracks","ABR_MODE_CHANGED","mode","AUTO","tracks","textTrack","TEXT_TRACK_CHANGED","selectedTextTrack","audioTrack","AUDIO_TRACK_CHANGED","selectedAudioTrack","videoTrack","VIDEO_TRACK_CHANGED","selectedVideoTrack","copyDeep","_source","_config","range","getLiveSeekableRange","seek","end","removeAttribute","removeChild","attach","audioTracksManager","getAudioTracksManager","castAudioTracks","getTracks","audioTracks","_parseAudioTracks","textTracksManager","getTextTracksManager","castTextTracks","textTracks","_parseTextTracks","concat","track","settings","trackId","index","label","language","kind","subType","active","push","set","getCurrentTimeSec","getStartTimeOfDvrWindow","getDurationSec","VOLUME_CHANGE","playsinline","playbackRate","getPlaybackRate","crossOrigin","mutedAutoPlay","HLS","PROGRESSIVE","SMOOTH_STREAMING","playback","preload","disableUserCache","streamPriority","engine","format","ui","disable","code","TextStyleConverter","TrackType","getMediaInformation","_setInitialAudioTrack","audioLanguage","_setInitialTextTrack","textLanguage","REQUEST_EDIT_TRACKS_INFO","requestEvent","activeTrackIds","_handleAudioTrackSelection","_handleTextTrackSelection","textTrackStyle","_handleTextStyleSelection","TEXT","activeTextTrack","t","nextActiveTextTrack","selectTrack","offTrack","AUDIO","activeAudioTrack","nextActiveAudioTrack","textStyle","toPlayerTextStyle","setActiveByLanguage","audioTrackId","setActiveById","Ad","AdBreak","AdBreakType","CustomEventMessage","_timePercentEvent","AD_REACHED_25_PERCENT","AD_REACHED_50_PERCENT","AD_REACHED_75_PERCENT","_bindMethods","RequestData","sendLocalMediaRequest","_onPlayerLoadComplete","_onBreakStarted","_onBreakEnded","_onBreakClipLoading","_onBreakClipStarted","_onBreakClipEnded","_onAdPaused","_onAdResumed","_onAdProgress","_onMuteChange","_onVolumeChange","_adLifecycleEventHand","_adTrackingEventHandl","_playerEventHandlers","_adLifecycleEventHandlers","BREAK_STARTED","BREAK_ENDED","BREAK_CLIP_LOADING","BREAK_CLIP_STARTED","BREAK_CLIP_ENDED","_adTrackingEventHandlers","MUTE_CHANGE","positions","breakManager","getBreakManager","breaks","getBreaks","b","_sendEventAndCustomMessage","AD_MANIFEST_LOADED","adBreaksPosition","breaksEvent","_toggleAdBreakListeners","adBreakOptions","_getAdBreakOptions","adBreak","AD_BREAK_START","_adBreak","AD_BREAK_END","findIndex","breakId","ALL_ADS_COMPLETED","adOptions","_getAdOptions","ad","breakClipId","AD_LOADED","_ad","AD_STARTED","_adIsPlaying","AD_COMPLETED","_adCanSkipTriggered","AD_PAUSED","AD_RESUMED","adDuration","getBreakClipDurationSec","adCurrentTime","getBreakClipCurrentTimeSec","percent","AD_FIRST_QUARTILE","AD_MIDPOINT","AD_THIRD_QUARTILE","skippable","skipOffset","AD_CAN_SKIP","AD_PROGRESS","adProgress","AD_MUTED","AD_VOLUME_CHANGED","toggle","_adProgressIntervalId","setInterval","clearInterval","currentBreak","getBreakById","_getAdBreakTypeByPosition","numAds","breakClipIds","PRE","POST","MID","currentBreakClip","getBreakClipById","indexOf","clickThroughUrl","posterUrl","whenSkippable","linear","toUpperCase","sendCustomMessage"],"mappings":"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","file":"playkit-cast-receiver.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"kaltura-player-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"receiver\", [\"kaltura-player-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"receiver\"] = factory(require(\"kaltura-player-js\"));\n\telse\n\t\troot[\"KalturaPlayer\"] = root[\"KalturaPlayer\"] || {}, root[\"KalturaPlayer\"][\"cast\"] = root[\"KalturaPlayer\"][\"cast\"] || {}, root[\"KalturaPlayer\"][\"cast\"][\"receiver\"] = factory(root[\"KalturaPlayer\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"kaltura-player-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"receiver\", [\"kaltura-player-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"receiver\"] = factory(require(\"kaltura-player-js\"));\n\telse\n\t\troot[\"KalturaPlayer\"] = root[\"KalturaPlayer\"] || {}, root[\"KalturaPlayer\"][\"cast\"] = root[\"KalturaPlayer\"][\"cast\"] || {}, root[\"KalturaPlayer\"][\"cast\"][\"receiver\"] = factory(root[\"KalturaPlayer\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 3);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReceiverManager = exports.CUSTOM_CHANNEL = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nvar _playerLoader = __webpack_require__(2);\n\nvar _receiverTracksManager = __webpack_require__(9);\n\nvar _receiverAdsManager = __webpack_require__(10);\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FakeEvent = _kalturaPlayerJs.core.FakeEvent,\n    EventManager = _kalturaPlayerJs.core.EventManager,\n    DrmScheme = _kalturaPlayerJs.core.DrmScheme,\n    Utils = _kalturaPlayerJs.core.Utils,\n    getLogger = _kalturaPlayerJs.core.getLogger;\nvar CustomMessageType = _kalturaPlayerJs.cast.CustomMessageType,\n    CustomActionType = _kalturaPlayerJs.cast.CustomActionType,\n    CustomActionMessage = _kalturaPlayerJs.cast.CustomActionMessage;\nvar CUSTOM_CHANNEL = exports.CUSTOM_CHANNEL = 'urn:x-cast:com.kaltura.cast.playkit';\nvar LIVE_EDGE = -1;\n\nvar ReceiverManager = function () {\n  function ReceiverManager(config) {\n    var _messageInterceptorsH, _playerManagerEventHa;\n\n    _classCallCheck(this, ReceiverManager);\n\n    this._logger = getLogger('ReceiverManager');\n    this._shouldAutoPlay = true;\n    this._firstPlay = true;\n    this._messageInterceptorsHandlers = (_messageInterceptorsH = {}, _defineProperty(_messageInterceptorsH, cast.framework.messages.MessageType.LOAD, this.onLoad), _defineProperty(_messageInterceptorsH, cast.framework.messages.MessageType.MEDIA_STATUS, this.onMediaStatus), _defineProperty(_messageInterceptorsH, cast.framework.messages.MessageType.STOP, this.onStop), _messageInterceptorsH);\n    this._playerManagerEventHandlers = (_playerManagerEventHa = {}, _defineProperty(_playerManagerEventHa, cast.framework.events.EventType.REQUEST_PLAY, this._onRequestPlayEvent), _defineProperty(_playerManagerEventHa, cast.framework.events.EventType.REQUEST_PAUSE, this._onRequestPauseEvent), _defineProperty(_playerManagerEventHa, cast.framework.events.EventType.PLAY, this._onPlayEvent), _defineProperty(_playerManagerEventHa, cast.framework.events.EventType.PLAYER_LOAD_COMPLETE, this._onPlayerLoadCompleteEvent), _playerManagerEventHa);\n    this._castContextEventHandlers = _defineProperty({}, cast.framework.system.EventType.SYSTEM_VOLUME_CHANGED, this._onSystemVolumeChangedEvent);\n\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._eventManager = new EventManager();\n    this._player = _playerLoader.PlayerLoader.loadPlayer(config);\n    this._tracksManager = new _receiverTracksManager.ReceiverTracksManager(this._player);\n    this._adsManager = new _receiverAdsManager.ReceiverAdsManager(this._player);\n    this._attachListeners();\n  }\n\n  _createClass(ReceiverManager, [{\n    key: 'getPlayer',\n    value: function getPlayer() {\n      return this._player;\n    }\n  }, {\n    key: 'start',\n    value: function start(options) {\n      var defaultOptions = new cast.framework.CastReceiverOptions();\n      defaultOptions.customNamespaces = _defineProperty({}, CUSTOM_CHANNEL, cast.framework.system.MessageType.JSON);\n      Utils.Object.mergeDeep(defaultOptions, options);\n      this._logger.debug('Start receiver', defaultOptions);\n      this._context.start(defaultOptions);\n    }\n  }, {\n    key: 'onLoad',\n    value: function onLoad(loadRequestData) {\n      var _this = this;\n\n      this._logger.debug('onLoad', loadRequestData);\n      this._reset();\n      return new Promise(function (resovle, reject) {\n        var mediaInfo = loadRequestData.media.customData.mediaInfo;\n        _this._maybeCreateVmapAdsRequest(loadRequestData.media);\n        _this._maybeReplaceAdTagTimestamp(loadRequestData.media);\n        _this._eventManager.listen(_this._player, _this._player.Event.ERROR, function (event) {\n          return reject(event);\n        });\n        _this._eventManager.listen(_this._player, _this._player.Event.SOURCE_SELECTED, function (event) {\n          return _this._onSourceSelected(event, loadRequestData, resovle);\n        });\n        _this._player.loadMedia(mediaInfo);\n      });\n    }\n  }, {\n    key: 'onStop',\n    value: function onStop(requestData) {\n      this._logger.debug('onStop', requestData);\n      this._destroy();\n      return requestData;\n    }\n  }, {\n    key: 'onMediaStatus',\n    value: function onMediaStatus(mediaStatus) {\n      this._logger.debug('mediaStatus', mediaStatus);\n      mediaStatus.customData = mediaStatus.customData || {};\n      if (this._player) {\n        mediaStatus.customData.mediaInfo = this._player.getMediaInfo();\n        if (this._player.isLive()) {\n          mediaStatus.currentTime = this._player.currentTime;\n          if (mediaStatus.media) {\n            mediaStatus.media.duration = this._player.duration;\n          }\n        }\n      }\n      if (mediaStatus.playerState !== this._playerManager.getPlayerState()) {\n        mediaStatus.playerState = this._playerManager.getPlayerState();\n      }\n      return mediaStatus;\n    }\n  }, {\n    key: '_attachListeners',\n    value: function _attachListeners() {\n      var _this2 = this;\n\n      this._context.addCustomMessageListener(CUSTOM_CHANNEL, function (customMessage) {\n        return _this2._onCustomMessage(customMessage);\n      });\n      Object.keys(this._playerManagerEventHandlers).forEach(function (event) {\n        return _this2._playerManager.addEventListener(event, _this2._playerManagerEventHandlers[event].bind(_this2));\n      });\n      Object.keys(this._messageInterceptorsHandlers).forEach(function (msg) {\n        return _this2._playerManager.setMessageInterceptor(msg, _this2._messageInterceptorsHandlers[msg].bind(_this2));\n      });\n      Object.keys(this._castContextEventHandlers).forEach(function (event) {\n        return _this2._context.addEventListener(event, _this2._castContextEventHandlers[event].bind(_this2));\n      });\n    }\n  }, {\n    key: '_reset',\n    value: function _reset() {\n      this._shouldAutoPlay = true;\n      this._firstPlay = true;\n      this._eventManager.removeAll();\n      this._player.reset();\n    }\n  }, {\n    key: '_destroy',\n    value: function _destroy() {\n      this._shouldAutoPlay = true;\n      this._firstPlay = true;\n      this._eventManager.destroy();\n      this._player.destroy();\n    }\n  }, {\n    key: '_onSourceSelected',\n    value: function _onSourceSelected(event, loadRequestData, resolve) {\n      var source = event.payload.selectedSource[0];\n      this._handleAutoPlay(loadRequestData);\n      this._handleLiveDvr(loadRequestData);\n      this._setMediaInfo(loadRequestData, source);\n      this._maybeSetDrmLicenseUrl(source);\n      resolve(loadRequestData);\n    }\n  }, {\n    key: '_setMediaInfo',\n    value: function _setMediaInfo(loadRequestData, source) {\n      loadRequestData.media.contentId = loadRequestData.media.contentId || source.id;\n      loadRequestData.media.contentUrl = loadRequestData.media.contentUrl || source.url;\n      loadRequestData.media.contentType = loadRequestData.media.contentType || source.mimetype;\n      loadRequestData.media.streamType = this._player.isLive() ? cast.framework.messages.StreamType.LIVE : cast.framework.messages.StreamType.BUFFERED;\n      loadRequestData.media.metadata = loadRequestData.media.metadata || new cast.framework.messages.GenericMediaMetadata();\n      loadRequestData.media.metadata.title = loadRequestData.media.metadata.title || this._player.config.sources.metadata.name;\n      loadRequestData.media.metadata.subtitle = loadRequestData.media.metadata.subtitle || this._player.config.sources.metadata.description;\n      loadRequestData.media.metadata.images = loadRequestData.media.metadata.images || [{ url: this._player.config.sources.poster }];\n      loadRequestData.media.hlsSegmentFormat = loadRequestData.media.hlsSegmentFormat || cast.framework.messages.HlsSegmentFormat.TS;\n      this._logger.debug('Media info has been set', loadRequestData);\n    }\n  }, {\n    key: '_handleAutoPlay',\n    value: function _handleAutoPlay(loadRequestData) {\n      if (!loadRequestData.autoplay) {\n        this._shouldAutoPlay = false;\n        loadRequestData.autoplay = true;\n      }\n    }\n  }, {\n    key: '_handleLiveDvr',\n    value: function _handleLiveDvr(loadRequestData) {\n      if (this._player.isDvr()) {\n        if (loadRequestData.currentTime === LIVE_EDGE) {\n          delete loadRequestData.currentTime;\n          this._logger.debug('Live DVR will seek to live edge');\n        }\n        // Workaround to avoid Live & Dvr seek issue\n        this._playerManager.removeSupportedMediaCommands(cast.framework.messages.Command.SEEK);\n      } else if (!this._player.isLive()) {\n        this._playerManager.addSupportedMediaCommands(cast.framework.messages.Command.SEEK);\n      }\n    }\n  }, {\n    key: '_maybeSetDrmLicenseUrl',\n    value: function _maybeSetDrmLicenseUrl(source) {\n      var _this3 = this;\n\n      if (source.drmData) {\n        var data = source.drmData.find(function (data) {\n          return data.scheme === DrmScheme.WIDEVINE;\n        });\n        if (data) {\n          this._playerManager.setMediaPlaybackInfoHandler(function (loadRequest, playbackConfig) {\n            playbackConfig.protectionSystem = cast.framework.ContentProtection.WIDEVINE;\n            playbackConfig.licenseUrl = data.licenseUrl;\n            _this3._logger.debug('Set drm license url', playbackConfig);\n            return playbackConfig;\n          });\n        }\n      }\n    }\n  }, {\n    key: '_onPlayEvent',\n    value: function _onPlayEvent() {\n      this._logger.debug('Play event', { firstPlay: this._firstPlay });\n      if (this._firstPlay) {\n        if (this._shouldAutoPlay) {\n          this._player.play();\n        } else {\n          this._playerManager.pause();\n        }\n        this._firstPlay = false;\n      }\n    }\n  }, {\n    key: '_onRequestPlayEvent',\n    value: function _onRequestPlayEvent() {\n      this._logger.debug('Request play event');\n      this._player.play();\n    }\n  }, {\n    key: '_onRequestPauseEvent',\n    value: function _onRequestPauseEvent() {\n      this._logger.debug('Request pause event');\n      this._player.pause();\n    }\n  }, {\n    key: '_onPlayerLoadCompleteEvent',\n    value: function _onPlayerLoadCompleteEvent() {\n      var _this4 = this;\n\n      this._player.load();\n      this._player.ready().then(function () {\n        return _this4._tracksManager.setInitialTracks();\n      });\n    }\n  }, {\n    key: '_onSystemVolumeChangedEvent',\n    value: function _onSystemVolumeChangedEvent(systemVolumeChangedEvent) {\n      var data = systemVolumeChangedEvent.data;\n      if (this._player.volume !== data.level) {\n        this._player.volume = data.level;\n      }\n      if (this._player.muted !== data.muted) {\n        this._player.muted = data.muted;\n      }\n    }\n  }, {\n    key: '_onCustomMessage',\n    value: function _onCustomMessage(customMessageEvent) {\n      var customMessage = customMessageEvent.data;\n      this._logger.debug('Custom message received', customMessage);\n      switch (customMessage.type) {\n        case CustomMessageType.ACTION:\n          this._handleCustomAction(customMessage);\n          break;\n        default:\n          break;\n      }\n    }\n  }, {\n    key: '_handleCustomAction',\n    value: function _handleCustomAction(customAction) {\n      switch (customAction.action) {\n        case CustomActionType.SKIP_AD:\n          this._adsManager.skipAd();\n          break;\n        default:\n          break;\n      }\n    }\n  }, {\n    key: '_maybeCreateVmapAdsRequest',\n    value: function _maybeCreateVmapAdsRequest(media) {\n      if (media.customData && media.customData.vmapAdsRequest) {\n        media.vmapAdsRequest = media.customData.vmapAdsRequest;\n      }\n    }\n  }, {\n    key: '_maybeReplaceAdTagTimestamp',\n    value: function _maybeReplaceAdTagTimestamp(media) {\n      var replaceTimestamp = function replaceTimestamp(adtag) {\n        if (adtag && regex.test(adtag)) {\n          var match = adtag.match(regex);\n          return adtag.replace(match[1], Date.now());\n        }\n        return adtag;\n      };\n      var regex = /correlator=(\\[timestamp\\])/;\n      if (media.breakClips) {\n        var breakClips = media.breakClips;\n        breakClips.forEach(function (breakClip) {\n          if (breakClip.vastAdsRequest && breakClip.vastAdsRequest.adTagUrl) {\n            breakClip.vastAdsRequest.adTagUrl = replaceTimestamp(breakClip.vastAdsRequest.adTagUrl);\n          }\n        });\n      }\n      if (media.vmapAdsRequest) {\n        media.vmapAdsRequest.adTagUrl = replaceTimestamp(media.vmapAdsRequest.adTagUrl);\n      }\n    }\n  }]);\n\n  return ReceiverManager;\n}();\n\nexports.ReceiverManager = ReceiverManager;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PlayerLoader = exports.CAST_MEDIA_PLAYER_TAG = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nvar _castEngine = __webpack_require__(5);\n\nvar _defaultPlayerConfig = __webpack_require__(6);\n\nvar _error = __webpack_require__(7);\n\nvar _errorType = __webpack_require__(8);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Utils = _kalturaPlayerJs.core.Utils,\n    unRegisterEngine = _kalturaPlayerJs.core.unRegisterEngine,\n    registerEngine = _kalturaPlayerJs.core.registerEngine,\n    EngineType = _kalturaPlayerJs.core.EngineType;\nvar CAST_MEDIA_PLAYER_TAG = exports.CAST_MEDIA_PLAYER_TAG = 'cast-media-player';\nvar PLAYER_CONTAINER = 'kaltura-receiver-player-container';\n\nvar PlayerLoader = function () {\n  function PlayerLoader() {\n    _classCallCheck(this, PlayerLoader);\n  }\n\n  _createClass(PlayerLoader, null, [{\n    key: 'loadPlayer',\n    value: function loadPlayer(config) {\n      var castMediaPlayerEl = Utils.Dom.getElementsByTagName(CAST_MEDIA_PLAYER_TAG)[0];\n      if (castMediaPlayerEl) {\n        var castMediaElement = castMediaPlayerEl.getMediaElement();\n        castMediaElement.style.position = 'absolute';\n        var playerContainerEl = Utils.Dom.createElement('div');\n        playerContainerEl.id = PLAYER_CONTAINER;\n        Utils.Dom.appendChild(document.body, playerContainerEl);\n        unRegisterEngine(EngineType.HTML5);\n        registerEngine(EngineType.CAST, _castEngine.CastEngine);\n        var playerConfig = Utils.Object.mergeDeep({ targetId: PLAYER_CONTAINER }, _defaultPlayerConfig.DefaultPlayerConfig, config);\n        var player = (0, _kalturaPlayerJs.setup)(playerConfig);\n        Utils.Dom.prependTo(playerContainerEl, castMediaElement.parentNode);\n        return player;\n      } else {\n        throw new _error.ReceiverError(_errorType.ErrorType.CAST_ELEMENT_NOT_FOUND);\n      }\n    }\n  }]);\n\n  return PlayerLoader;\n}();\n\nexports.PlayerLoader = PlayerLoader;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NAME = exports.VERSION = exports.Receiver = undefined;\n\nvar _receiverManagerApi = __webpack_require__(4);\n\nexports.Receiver = _receiverManagerApi.ReceiverManagerAPI;\nexports.VERSION = \"0.1.3\";\nexports.NAME = \"@playkit-js/playkit-js-cast-receiver\";\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReceiverManagerAPI = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _receiverManager = __webpack_require__(1);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar receiverManager = void 0;\n\nvar ReceiverManagerAPI = function () {\n  function ReceiverManagerAPI(config) {\n    _classCallCheck(this, ReceiverManagerAPI);\n\n    receiverManager = new _receiverManager.ReceiverManager(config);\n  }\n\n  _createClass(ReceiverManagerAPI, [{\n    key: 'start',\n    value: function start() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      receiverManager.start(options);\n    }\n  }, {\n    key: 'onLoad',\n    value: function onLoad(loadRequestData) {\n      return receiverManager.onLoad(loadRequestData);\n    }\n  }, {\n    key: 'onStop',\n    value: function onStop(requestData) {\n      return receiverManager.onStop(requestData);\n    }\n  }, {\n    key: 'onMediaStatus',\n    value: function onMediaStatus(mediaStatus) {\n      return receiverManager.onMediaStatus(mediaStatus);\n    }\n  }, {\n    key: 'addEventListener',\n    value: function addEventListener(type, listener) {\n      receiverManager.getPlayer().addEventListener(type, listener);\n    }\n  }, {\n    key: 'removeEventListener',\n    value: function removeEventListener(type, listener) {\n      receiverManager.getPlayer().removeEventListener(type, listener);\n    }\n  }]);\n\n  return ReceiverManagerAPI;\n}();\n\nexports.ReceiverManagerAPI = ReceiverManagerAPI;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CastEngine = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nvar _playerLoader = __webpack_require__(2);\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Track = _kalturaPlayerJs.core.Track,\n    Utils = _kalturaPlayerJs.core.Utils,\n    FakeEvent = _kalturaPlayerJs.core.FakeEvent,\n    MediaType = _kalturaPlayerJs.core.MediaType,\n    getLogger = _kalturaPlayerJs.core.getLogger,\n    FakeEventTarget = _kalturaPlayerJs.core.FakeEventTarget,\n    EventManager = _kalturaPlayerJs.core.EventManager,\n    EventType = _kalturaPlayerJs.core.EventType,\n    AudioTrack = _kalturaPlayerJs.core.AudioTrack,\n    TextTrack = _kalturaPlayerJs.core.TextTrack,\n    AbrMode = _kalturaPlayerJs.core.AbrMode,\n    MimeType = _kalturaPlayerJs.core.MimeType;\n\nvar CastEngine = function (_FakeEventTarget) {\n  _inherits(CastEngine, _FakeEventTarget);\n\n  _createClass(CastEngine, null, [{\n    key: 'canPlaySource',\n    value: function canPlaySource(source) {\n      var mimeType = source.mimetype.toLowerCase();\n      var supported = CastEngine._supportedMimeTypes.includes(mimeType);\n      if (supported) {\n        if (source.drmData) {\n          return MimeType.DASH.includes(mimeType);\n        }\n        return true;\n      }\n      return false;\n    }\n  }, {\n    key: 'createEngine',\n    value: function createEngine(source, config) {\n      return new this(source, config);\n    }\n  }, {\n    key: 'id',\n    get: function get() {\n      return 'cast';\n    }\n  }]);\n\n  function CastEngine(source, config) {\n    _classCallCheck(this, CastEngine);\n\n    var _this = _possibleConstructorReturn(this, (CastEngine.__proto__ || Object.getPrototypeOf(CastEngine)).call(this));\n\n    _this._isLoaded = false;\n    _this._tracks = [];\n    _this._volume = 1;\n    _this._muted = false;\n    _this._paused = false;\n    _this._seeking = false;\n    _this._ended = false;\n    _this._mediaElementEvents = [EventType.ABORT, EventType.CAN_PLAY, EventType.CAN_PLAY_THROUGH, EventType.DURATION_CHANGE, EventType.EMPTIED, EventType.ENDED, EventType.LOADED_DATA, EventType.LOADED_METADATA, EventType.LOAD_START, EventType.PAUSE, EventType.PLAY, EventType.PLAYING, EventType.PROGRESS, EventType.RATE_CHANGE, EventType.SEEKED, EventType.SEEKING, EventType.STALLED, EventType.TIME_UPDATE, EventType.SUSPEND, EventType.WAITING];\n\n    _this._context = cast.framework.CastReceiverContext.getInstance();\n    _this._playerManager = _this._context.getPlayerManager();\n    _this._eventManager = new EventManager();\n    _this._createVideoElement();\n    _this._init(source, config);\n    return _this;\n  }\n\n  _createClass(CastEngine, [{\n    key: 'restore',\n    value: function restore(source, config) {\n      this.reset();\n      this._init(source, config);\n    }\n  }, {\n    key: 'attach',\n    value: function attach() {\n      var _this2 = this;\n\n      var videoElement = this.getVideoElement();\n      this._eventManager.listen(videoElement, EventType.SEEKED, function () {\n        return _this2._seeking = false;\n      });\n      this._eventManager.listen(videoElement, EventType.SEEKING, function () {\n        return _this2._seeking = true;\n      });\n      this._eventManager.listen(videoElement, EventType.ENDED, function () {\n        _this2._ended = true;\n        // Receiver has a problem where the current time isn't equals to the duration when\n        // playback is ended. This prevent from analytics plugins to report 100% reached.\n        // So we're trigger time update event again on ended and take care to handle this state also in the\n        // current time setter.\n        if (!_this2.isLive()) {\n          _this2.dispatchEvent(new FakeEvent(EventType.TIME_UPDATE));\n        }\n      });\n      if (this.isLive()) {\n        this._eventManager.listen(videoElement, EventType.TIME_UPDATE, function () {\n          return _this2._playerManager.broadcastStatus(true);\n        });\n      }\n      this._mediaElementEvents.forEach(function (mediaElementEvent) {\n        return _this2._eventManager.listen(videoElement, mediaElementEvent, function () {\n          return _this2.dispatchEvent(new FakeEvent(mediaElementEvent));\n        });\n      });\n    }\n  }, {\n    key: 'detach',\n    value: function detach() {\n      // Empty implementation\n    }\n  }, {\n    key: 'getVideoElement',\n    value: function getVideoElement() {\n      return this._el;\n    }\n  }, {\n    key: 'load',\n    value: function load(startTime) {\n      CastEngine._logger.debug('Load start', startTime);\n      this._isLoaded = true;\n      this._parseTracks();\n      this.dispatchEvent(new FakeEvent(EventType.ABR_MODE_CHANGED, { mode: AbrMode.AUTO }));\n      CastEngine._logger.debug('Load end', this._tracks);\n      return Promise.resolve({ tracks: this._tracks });\n    }\n  }, {\n    key: 'play',\n    value: function play() {\n      this._paused = false;\n    }\n  }, {\n    key: 'pause',\n    value: function pause() {\n      this._paused = true;\n    }\n  }, {\n    key: 'hideTextTrack',\n    value: function hideTextTrack() {\n      // Empty implementation\n    }\n  }, {\n    key: 'selectTextTrack',\n    value: function selectTextTrack(textTrack) {\n      this.dispatchEvent(new FakeEvent(EventType.TEXT_TRACK_CHANGED, { selectedTextTrack: textTrack }));\n    }\n  }, {\n    key: 'selectAudioTrack',\n    value: function selectAudioTrack(audioTrack) {\n      this.dispatchEvent(new FakeEvent(EventType.AUDIO_TRACK_CHANGED, { selectedAudioTrack: audioTrack }));\n    }\n  }, {\n    key: 'selectVideoTrack',\n    value: function selectVideoTrack(videoTrack) {\n      this.dispatchEvent(new FakeEvent(EventType.VIDEO_TRACK_CHANGED, { selectedVideoTrack: videoTrack }));\n    }\n  }, {\n    key: 'enableAdaptiveBitrate',\n    value: function enableAdaptiveBitrate() {\n      // Empty implementation\n    }\n  }, {\n    key: 'isAdaptiveBitrateEnabled',\n    value: function isAdaptiveBitrateEnabled() {\n      return true;\n    }\n  }, {\n    key: 'getSelectedSource',\n    value: function getSelectedSource() {\n      return Utils.Object.copyDeep(this._source);\n    }\n  }, {\n    key: 'isLive',\n    value: function isLive() {\n      return this._config.sources.type === MediaType.LIVE;\n    }\n  }, {\n    key: 'seekToLiveEdge',\n    value: function seekToLiveEdge() {\n      var range = this._playerManager.getLiveSeekableRange();\n      if (range) {\n        this._playerManager.seek(range.end);\n      }\n    }\n  }, {\n    key: 'getStartTimeOfDvrWindow',\n    value: function getStartTimeOfDvrWindow() {\n      var range = this._playerManager.getLiveSeekableRange();\n      if (range) {\n        return range.start;\n      }\n      return 0;\n    }\n  }, {\n    key: 'reset',\n    value: function reset() {\n      this._eventManager.removeAll();\n      this._tracks = [];\n      this._isLoaded = false;\n      this._paused = false;\n      this._seeking = false;\n      this._ended = false;\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this._eventManager.destroy();\n      this._tracks = [];\n      this._isLoaded = false;\n      this._mediaElementEvents = [];\n      this._volume = 1;\n      this._muted = false;\n      this._paused = false;\n      this._seeking = false;\n      this._ended = false;\n      if (this._el) {\n        Utils.Dom.removeAttribute(this._el, 'src');\n        Utils.Dom.removeChild(this._el.parentNode, this._el);\n      }\n    }\n  }, {\n    key: '_createVideoElement',\n    value: function _createVideoElement() {\n      var castMediaPlayerEl = document.getElementsByTagName(_playerLoader.CAST_MEDIA_PLAYER_TAG)[0];\n      if (castMediaPlayerEl) {\n        this._el = castMediaPlayerEl.getMediaElement();\n      }\n    }\n  }, {\n    key: '_init',\n    value: function _init(source, config) {\n      this._source = source;\n      this._config = config;\n      this.attach();\n    }\n  }, {\n    key: '_parseTracks',\n    value: function _parseTracks() {\n      var audioTracksManager = this._playerManager.getAudioTracksManager();\n      var castAudioTracks = audioTracksManager.getTracks();\n      var audioTracks = this._parseAudioTracks(castAudioTracks);\n\n      var textTracksManager = this._playerManager.getTextTracksManager();\n      var castTextTracks = textTracksManager.getTracks();\n      var textTracks = this._parseTextTracks(castTextTracks);\n\n      this._tracks = audioTracks.concat(textTracks);\n    }\n  }, {\n    key: '_parseTextTracks',\n    value: function _parseTextTracks(castTextTracks) {\n      var textTracks = [];\n      castTextTracks.forEach(function (track) {\n        var settings = {\n          id: track.trackId,\n          index: track.trackId - 1,\n          label: track.name,\n          language: track.language,\n          kind: track.subType || 'subtitles',\n          active: false\n        };\n        textTracks.push(new TextTrack(settings));\n      });\n      return textTracks;\n    }\n  }, {\n    key: '_parseAudioTracks',\n    value: function _parseAudioTracks(castAudioTracks) {\n      var audioTracks = [];\n      castAudioTracks.forEach(function (track) {\n        var settings = {\n          id: track.trackId,\n          index: track.trackId - 1,\n          label: track.name,\n          language: track.language,\n          active: false\n        };\n        audioTracks.push(new AudioTrack(settings));\n      });\n      return audioTracks;\n    }\n  }, {\n    key: 'id',\n    get: function get() {\n      return CastEngine.id;\n    }\n  }, {\n    key: 'currentTime',\n    set: function set(value) {\n      // Empty implementation\n    },\n    get: function get() {\n      if (this.isLive()) {\n        return this._playerManager.getCurrentTimeSec() - this.getStartTimeOfDvrWindow();\n      }\n      if (this._ended) {\n        return this._playerManager.getDurationSec();\n      }\n      return this._playerManager.getCurrentTimeSec();\n    }\n  }, {\n    key: 'muted',\n    set: function set(value) {\n      this._muted = value;\n    },\n    get: function get() {\n      return this._muted;\n    }\n  }, {\n    key: 'volume',\n    set: function set(value) {\n      this._volume = value;\n      this.dispatchEvent(EventType.VOLUME_CHANGE);\n    },\n    get: function get() {\n      return this._volume;\n    }\n  }, {\n    key: 'paused',\n    get: function get() {\n      return this._paused;\n    }\n  }, {\n    key: 'seeking',\n    get: function get() {\n      return this._seeking;\n    }\n  }, {\n    key: 'buffered',\n    get: function get() {\n      return [];\n    }\n  }, {\n    key: 'duration',\n    get: function get() {\n      if (this.isLive()) {\n        var range = this._playerManager.getLiveSeekableRange();\n        if (range) {\n          return range.end - this.getStartTimeOfDvrWindow();\n        }\n      }\n      return this._playerManager.getDurationSec();\n    }\n  }, {\n    key: 'src',\n    get: function get() {\n      return this._isLoaded ? this._source.url : '';\n    }\n  }, {\n    key: 'playsinline',\n    set: function set(playsinline) {\n      // Empty implementation\n    },\n    get: function get() {\n      return true;\n    }\n  }, {\n    key: 'playbackRate',\n    set: function set(playbackRate) {\n      // Empty implementation\n    },\n    get: function get() {\n      return this._playerManager.getPlaybackRate();\n    }\n  }, {\n    key: 'playbackRates',\n    get: function get() {\n      return [1];\n    }\n  }, {\n    key: 'defaultPlaybackRate',\n    get: function get() {\n      return 1;\n    }\n  }, {\n    key: 'crossOrigin',\n    set: function set(crossOrigin) {\n      // Empty implementation\n    },\n    get: function get() {\n      // Empty implementation\n    }\n  }, {\n    key: 'ended',\n    get: function get() {\n      return this._ended;\n    }\n  }], [{\n    key: 'runCapabilities',\n    value: function runCapabilities() {\n      // Empty implementation\n    }\n  }, {\n    key: 'prepareVideoElement',\n    value: function prepareVideoElement() {\n      // Empty implementation\n    }\n  }, {\n    key: 'getCapabilities',\n    value: function getCapabilities() {\n      return Promise.resolve(_defineProperty({}, CastEngine.id, {\n        autoplay: true,\n        mutedAutoPlay: true\n      }));\n    }\n  }]);\n\n  return CastEngine;\n}(FakeEventTarget);\n\nCastEngine._logger = getLogger('CastEngine');\nCastEngine._supportedMimeTypes = [].concat(_toConsumableArray(MimeType.HLS), _toConsumableArray(MimeType.DASH), _toConsumableArray(MimeType.PROGRESSIVE), _toConsumableArray(MimeType.SMOOTH_STREAMING));\nexports.CastEngine = CastEngine;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DefaultPlayerConfig = undefined;\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nvar StreamType = _kalturaPlayerJs.core.StreamType,\n    EngineType = _kalturaPlayerJs.core.EngineType;\n\n\nvar DefaultPlayerConfig = {\n  playback: {\n    autoplay: false,\n    preload: 'none',\n    disableUserCache: true,\n    streamPriority: [{\n      engine: EngineType.CAST,\n      format: StreamType.HLS\n    }, {\n      engine: EngineType.CAST,\n      format: StreamType.DASH\n    }, {\n      engine: EngineType.CAST,\n      format: StreamType.PROGRESSIVE\n    }]\n  },\n  ui: {\n    disable: true\n  }\n};\n\nexports.DefaultPlayerConfig = DefaultPlayerConfig;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ReceiverError = function ReceiverError(type) {\n  _classCallCheck(this, ReceiverError);\n\n  this.code = type.code;\n  this.description = type.description;\n};\n\nexports.ReceiverError = ReceiverError;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ErrorType = {\n  CAST_ELEMENT_NOT_FOUND: {\n    code: 100020,\n    description: \"<cast-media-element> tag isn't found in the DOM\"\n  }\n};\n\nexports.ErrorType = ErrorType;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReceiverTracksManager = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TextStyleConverter = _kalturaPlayerJs.cast.TextStyleConverter;\nvar TrackType = _kalturaPlayerJs.core.TrackType,\n    getLogger = _kalturaPlayerJs.core.getLogger;\n\nvar ReceiverTracksManager = function () {\n  function ReceiverTracksManager(player) {\n    _classCallCheck(this, ReceiverTracksManager);\n\n    this._logger = getLogger('ReceiverTracksManager');\n\n    this._playerManager = cast.framework.CastReceiverContext.getInstance().getPlayerManager();\n    this._player = player;\n    this._attachListeners();\n  }\n\n  _createClass(ReceiverTracksManager, [{\n    key: 'setInitialTracks',\n    value: function setInitialTracks() {\n      var mediaInfo = this._playerManager.getMediaInformation();\n      this._logger.debug('Set initial tracks', mediaInfo.customData);\n      if (mediaInfo.customData) {\n        this._setInitialAudioTrack(mediaInfo.customData.audioLanguage);\n        this._setInitialTextTrack(mediaInfo.customData.textLanguage);\n      }\n    }\n  }, {\n    key: '_attachListeners',\n    value: function _attachListeners() {\n      var _this = this;\n\n      this._playerManager.addEventListener(cast.framework.events.EventType.REQUEST_EDIT_TRACKS_INFO, function (requestEvent) {\n        var activeTrackIds = requestEvent.requestData.activeTrackIds;\n        if (activeTrackIds) {\n          _this._handleAudioTrackSelection(activeTrackIds);\n          _this._handleTextTrackSelection(activeTrackIds);\n        } else {\n          var textTrackStyle = requestEvent.requestData.textTrackStyle;\n          _this._handleTextStyleSelection(textTrackStyle);\n        }\n      });\n    }\n  }, {\n    key: '_handleTextTrackSelection',\n    value: function _handleTextTrackSelection(activeTrackIds) {\n      var textTracks = this._player.getTracks(TrackType.TEXT);\n      var activeTextTrack = textTracks.find(function (t) {\n        return t.active;\n      });\n      var nextActiveTextTrack = textTracks.find(function (t) {\n        return activeTrackIds.includes(t.id);\n      });\n      if (nextActiveTextTrack) {\n        this._player.selectTrack(nextActiveTextTrack);\n      } else if (activeTextTrack.language !== 'off') {\n        var offTrack = textTracks.find(function (t) {\n          return t.language === 'off';\n        });\n        this._player.selectTrack(offTrack);\n      }\n    }\n  }, {\n    key: '_handleAudioTrackSelection',\n    value: function _handleAudioTrackSelection(activeTrackIds) {\n      var audioTracks = this._player.getTracks(TrackType.AUDIO);\n      var activeAudioTrack = audioTracks.find(function (t) {\n        return t.active;\n      });\n      var nextActiveAudioTrack = audioTracks.find(function (t) {\n        return activeTrackIds.includes(t.id);\n      });\n      if (activeAudioTrack.id !== nextActiveAudioTrack.id) {\n        this._player.selectTrack(nextActiveAudioTrack);\n      }\n    }\n  }, {\n    key: '_handleTextStyleSelection',\n    value: function _handleTextStyleSelection(textStyle) {\n      this._player.textStyle = TextStyleConverter.toPlayerTextStyle(textStyle);\n    }\n  }, {\n    key: '_setInitialTextTrack',\n    value: function _setInitialTextTrack(textLanguage) {\n      var textTracksManager = this._playerManager.getTextTracksManager();\n      if (textLanguage) {\n        this._logger.debug('Set initial text track - setActiveByLanguage', textLanguage);\n        textTracksManager.setActiveByLanguage(textLanguage);\n      }\n    }\n  }, {\n    key: '_setInitialAudioTrack',\n    value: function _setInitialAudioTrack(audioLanguage) {\n      var audioTracksManager = this._playerManager.getAudioTracksManager();\n      var audioTracks = audioTracksManager.getTracks();\n      this._logger.debug('Set initial audio track', audioLanguage, audioTracks);\n      if (audioTracks.length > 0) {\n        if (audioLanguage) {\n          this._logger.debug('Set initial audio track - setActiveByLanguage', audioLanguage);\n          audioTracksManager.setActiveByLanguage(audioLanguage);\n        } else {\n          var audioTrackId = audioTracks[0].trackId;\n          var audioTrack = this._player.getTracks(TrackType.AUDIO).find(function (t) {\n            return t.id === audioTrackId;\n          });\n          if (audioTrack) {\n            this._logger.debug('Set initial audio track - setActiveById', audioTrackId);\n            audioTracksManager.setActiveById(audioTrackId);\n            this._player.selectTrack(audioTrack);\n          }\n        }\n      }\n    }\n  }]);\n\n  return ReceiverTracksManager;\n}();\n\nexports.ReceiverTracksManager = ReceiverTracksManager;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReceiverAdsManager = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nvar _receiverManager = __webpack_require__(1);\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar EventType = _kalturaPlayerJs.core.EventType,\n    Ad = _kalturaPlayerJs.core.Ad,\n    AdBreak = _kalturaPlayerJs.core.AdBreak,\n    AdBreakType = _kalturaPlayerJs.core.AdBreakType,\n    getLogger = _kalturaPlayerJs.core.getLogger;\nvar CustomEventMessage = _kalturaPlayerJs.cast.CustomEventMessage;\n\nvar ReceiverAdsManager = function () {\n  function ReceiverAdsManager(player) {\n    _classCallCheck(this, ReceiverAdsManager);\n\n    this._logger = getLogger('ReceiverAdsManager');\n    this._timePercentEvent = {\n      AD_REACHED_25_PERCENT: false,\n      AD_REACHED_50_PERCENT: false,\n      AD_REACHED_75_PERCENT: false\n    };\n\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._player = player;\n    this._bindMethods();\n    this._attachListeners();\n  }\n\n  _createClass(ReceiverAdsManager, [{\n    key: 'skipAd',\n    value: function skipAd() {\n      this._logger.debug('Skip ad');\n      var requestData = new cast.framework.messages.RequestData(cast.framework.messages.MessageType.SKIP_AD);\n      this._playerManager.sendLocalMediaRequest(requestData);\n    }\n  }, {\n    key: '_bindMethods',\n    value: function _bindMethods() {\n      this._onPlayerLoadComplete = this._onPlayerLoadComplete.bind(this);\n      this._onBreakStarted = this._onBreakStarted.bind(this);\n      this._onBreakEnded = this._onBreakEnded.bind(this);\n      this._onBreakClipLoading = this._onBreakClipLoading.bind(this);\n      this._onBreakClipStarted = this._onBreakClipStarted.bind(this);\n      this._onBreakClipEnded = this._onBreakClipEnded.bind(this);\n      this._onAdPaused = this._onAdPaused.bind(this);\n      this._onAdResumed = this._onAdResumed.bind(this);\n      this._onAdProgress = this._onAdProgress.bind(this);\n      this._onMuteChange = this._onMuteChange.bind(this);\n      this._onVolumeChange = this._onVolumeChange.bind(this);\n    }\n  }, {\n    key: '_attachListeners',\n    value: function _attachListeners() {\n      var _adLifecycleEventHand,\n          _adTrackingEventHandl,\n          _playerEventHandlers,\n          _this = this;\n\n      this._adLifecycleEventHandlers = (_adLifecycleEventHand = {}, _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.PLAYER_LOAD_COMPLETE, this._onPlayerLoadComplete), _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.BREAK_STARTED, this._onBreakStarted), _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.BREAK_ENDED, this._onBreakEnded), _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.BREAK_CLIP_LOADING, this._onBreakClipLoading), _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.BREAK_CLIP_STARTED, this._onBreakClipStarted), _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.BREAK_CLIP_ENDED, this._onBreakClipEnded), _adLifecycleEventHand);\n      this._adTrackingEventHandlers = (_adTrackingEventHandl = {}, _defineProperty(_adTrackingEventHandl, cast.framework.events.EventType.PAUSE, this._onAdPaused), _defineProperty(_adTrackingEventHandl, cast.framework.events.EventType.PLAY, this._onAdResumed), _adTrackingEventHandl);\n      this._playerEventHandlers = (_playerEventHandlers = {}, _defineProperty(_playerEventHandlers, EventType.MUTE_CHANGE, this._onMuteChange), _defineProperty(_playerEventHandlers, EventType.VOLUME_CHANGE, this._onVolumeChange), _playerEventHandlers);\n      Object.keys(this._adLifecycleEventHandlers).forEach(function (event) {\n        return _this._playerManager.addEventListener(event, _this._adLifecycleEventHandlers[event]);\n      });\n    }\n  }, {\n    key: '_onPlayerLoadComplete',\n    value: function _onPlayerLoadComplete() {\n      var positions = [];\n      var breakManager = this._playerManager.getBreakManager();\n      if (breakManager) {\n        var breaks = breakManager.getBreaks();\n        if (breaks && breaks.length > 0) {\n          breaks.forEach(function (b) {\n            return positions.push(b.position);\n          });\n          this._sendEventAndCustomMessage(this._player.Event.AD_MANIFEST_LOADED, { adBreaksPosition: positions });\n        }\n      }\n    }\n  }, {\n    key: '_onBreakStarted',\n    value: function _onBreakStarted(breaksEvent) {\n      this._toggleAdBreakListeners(true);\n      var adBreakOptions = this._getAdBreakOptions(breaksEvent);\n      var adBreak = new AdBreak(adBreakOptions);\n      this._sendEventAndCustomMessage(this._player.Event.AD_BREAK_START, { adBreak: adBreak });\n      this._adBreak = adBreak;\n    }\n  }, {\n    key: '_onBreakEnded',\n    value: function _onBreakEnded(breaksEvent) {\n      this._toggleAdBreakListeners(false);\n      this._sendEventAndCustomMessage(this._player.Event.AD_BREAK_END);\n      this._adBreak = null;\n      var breaks = this._playerManager.getBreakManager().getBreaks();\n      var index = breaks.findIndex(function (b) {\n        return b.id === breaksEvent.breakId;\n      });\n      if (index + 1 === breaks.length) {\n        this._sendEventAndCustomMessage(this._player.Event.ALL_ADS_COMPLETED);\n      }\n    }\n  }, {\n    key: '_onBreakClipLoading',\n    value: function _onBreakClipLoading(breaksEvent) {\n      var adOptions = this._getAdOptions(breaksEvent);\n      var ad = new Ad(breaksEvent.breakClipId, adOptions);\n      this._sendEventAndCustomMessage(this._player.Event.AD_LOADED, { ad: ad });\n      this._ad = ad;\n    }\n  }, {\n    key: '_onBreakClipStarted',\n    value: function _onBreakClipStarted() {\n      this._sendEventAndCustomMessage(this._player.Event.AD_STARTED);\n      this._adIsPlaying = true;\n    }\n  }, {\n    key: '_onBreakClipEnded',\n    value: function _onBreakClipEnded() {\n      this._sendEventAndCustomMessage(this._player.Event.AD_COMPLETED);\n      this._adIsPlaying = false;\n      this._adCanSkipTriggered = false;\n      this._ad = null;\n    }\n  }, {\n    key: '_onAdPaused',\n    value: function _onAdPaused() {\n      this._sendEventAndCustomMessage(this._player.Event.AD_PAUSED);\n      this._adIsPlaying = false;\n    }\n  }, {\n    key: '_onAdResumed',\n    value: function _onAdResumed() {\n      this._sendEventAndCustomMessage(this._player.Event.AD_RESUMED);\n      this._adIsPlaying = true;\n    }\n  }, {\n    key: '_onAdProgress',\n    value: function _onAdProgress() {\n      if (!this._ad) return;\n      var adDuration = this._playerManager.getBreakClipDurationSec();\n      var adCurrentTime = this._playerManager.getBreakClipCurrentTimeSec();\n      var percent = adCurrentTime / adDuration;\n      if (!this._timePercentEvent.AD_REACHED_25_PERCENT && percent >= 0.25) {\n        this._timePercentEvent.AD_REACHED_25_PERCENT = true;\n        this._sendEventAndCustomMessage(this._player.Event.AD_FIRST_QUARTILE);\n      }\n      if (!this._timePercentEvent.AD_REACHED_50_PERCENT && percent >= 0.5) {\n        this._timePercentEvent.AD_REACHED_50_PERCENT = true;\n        this._sendEventAndCustomMessage(this._player.Event.AD_MIDPOINT);\n      }\n      if (!this._timePercentEvent.AD_REACHED_75_PERCENT && percent >= 0.75) {\n        this._timePercentEvent.AD_REACHED_75_PERCENT = true;\n        this._sendEventAndCustomMessage(this._player.Event.AD_THIRD_QUARTILE);\n      }\n      if (!this._adCanSkipTriggered && this._ad.skippable) {\n        if (adCurrentTime >= this._ad.skipOffset) {\n          this._sendEventAndCustomMessage(this._player.Event.AD_CAN_SKIP);\n          this._adCanSkipTriggered = true;\n        }\n      }\n      this._sendEventAndCustomMessage(this._player.Event.AD_PROGRESS, {\n        adProgress: {\n          currentTime: adCurrentTime,\n          duration: adDuration\n        }\n      });\n    }\n  }, {\n    key: '_onMuteChange',\n    value: function _onMuteChange() {\n      if (this._player.muted) {\n        this._sendEventAndCustomMessage(this._player.Event.AD_MUTED);\n      }\n    }\n  }, {\n    key: '_onVolumeChange',\n    value: function _onVolumeChange() {\n      this._sendEventAndCustomMessage(this._player.Event.AD_VOLUME_CHANGED);\n    }\n  }, {\n    key: '_toggleAdBreakListeners',\n    value: function _toggleAdBreakListeners(toggle) {\n      var _this2 = this;\n\n      if (toggle) {\n        Object.keys(this._adTrackingEventHandlers).forEach(function (event) {\n          return _this2._playerManager.addEventListener(event, _this2._adTrackingEventHandlers[event]);\n        });\n        Object.keys(this._playerEventHandlers).forEach(function (event) {\n          return _this2._player.addEventListener(event, _this2._playerEventHandlers[event]);\n        });\n        this._adProgressIntervalId = setInterval(this._onAdProgress, 300);\n      } else {\n        Object.keys(this._adTrackingEventHandlers).forEach(function (event) {\n          return _this2._playerManager.removeEventListener(event, _this2._adTrackingEventHandlers[event]);\n        });\n        Object.keys(this._playerEventHandlers).forEach(function (event) {\n          return _this2._player.removeEventListener(event, _this2._playerEventHandlers[event]);\n        });\n        clearInterval(this._adProgressIntervalId);\n        this._adProgressIntervalId = null;\n      }\n    }\n  }, {\n    key: '_getAdBreakOptions',\n    value: function _getAdBreakOptions(breaksEvent) {\n      var options = {};\n      var currentBreak = this._playerManager.getBreakManager().getBreakById(breaksEvent.breakId);\n      if (currentBreak) {\n        options.position = currentBreak.position;\n        options.type = this._getAdBreakTypeByPosition(currentBreak.position);\n        options.numAds = currentBreak.breakClipIds.length;\n      }\n      return options;\n    }\n  }, {\n    key: '_getAdBreakTypeByPosition',\n    value: function _getAdBreakTypeByPosition(position) {\n      switch (position) {\n        case 0:\n          return AdBreakType.PRE;\n        case -1:\n          return AdBreakType.POST;\n        default:\n          return AdBreakType.MID;\n      }\n    }\n  }, {\n    key: '_getAdOptions',\n    value: function _getAdOptions(breaksEvent) {\n      var options = {};\n      var currentBreak = this._playerManager.getBreakManager().getBreakById(breaksEvent.breakId);\n      var currentBreakClip = this._playerManager.getBreakManager().getBreakClipById(breaksEvent.breakClipId);\n      options.url = currentBreakClip.contentId;\n      options.contentType = currentBreakClip.contentType;\n      options.title = currentBreakClip.title;\n      options.position = currentBreak.breakClipIds.indexOf(currentBreakClip.id) + 1;\n      options.duration = currentBreakClip.duration;\n      options.clickThroughUrl = currentBreakClip.clickThroughUrl;\n      options.posterUrl = currentBreakClip.posterUrl;\n      options.skipOffset = currentBreakClip.whenSkippable;\n      options.linear = true;\n      return options;\n    }\n  }, {\n    key: '_sendEventAndCustomMessage',\n    value: function _sendEventAndCustomMessage(event, payload) {\n      this._logger.debug(event.toUpperCase(), payload);\n      this._player.dispatchEvent(event, payload);\n      this._context.sendCustomMessage(_receiverManager.CUSTOM_CHANNEL, undefined, new CustomEventMessage(event, payload));\n    }\n  }]);\n\n  return ReceiverAdsManager;\n}();\n\nexports.ReceiverAdsManager = ReceiverAdsManager;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// playkit-cast-receiver.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b67bb6a51662b0697f67","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"kaltura-player-js\",\"commonjs2\":\"kaltura-player-js\",\"amd\":\"kaltura-player-js\",\"root\":[\"KalturaPlayer\"]}\n// module id = 0\n// module chunks = 0","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\nimport {PlayerLoader} from './player-loader';\nimport {ReceiverTracksManager} from './receiver-tracks-manager';\nimport {ReceiverAdsManager} from './receiver-ads-manager';\n\nconst {FakeEvent, EventManager, DrmScheme, Utils, getLogger} = core;\nconst {CustomMessageType, CustomActionType, CustomActionMessage} = remote;\n\nexport const CUSTOM_CHANNEL = 'urn:x-cast:com.kaltura.cast.playkit';\nconst LIVE_EDGE = -1;\n\nclass ReceiverManager {\n  _logger: any = getLogger('ReceiverManager');\n  _context: Object;\n  _playerManager: Object;\n  _eventManager: EventManager;\n  _player: Object;\n  _shouldAutoPlay: boolean = true;\n  _firstPlay: boolean = true;\n  _tracksManager: ReceiverTracksManager;\n  _adsManager: ReceiverAdsManager;\n  _messageInterceptorsHandlers: {[message: string]: Function} = {\n    [cast.framework.messages.MessageType.LOAD]: this.onLoad,\n    [cast.framework.messages.MessageType.MEDIA_STATUS]: this.onMediaStatus,\n    [cast.framework.messages.MessageType.STOP]: this.onStop\n  };\n  _playerManagerEventHandlers: {[event: string]: Function} = {\n    [cast.framework.events.EventType.REQUEST_PLAY]: this._onRequestPlayEvent,\n    [cast.framework.events.EventType.REQUEST_PAUSE]: this._onRequestPauseEvent,\n    [cast.framework.events.EventType.PLAY]: this._onPlayEvent,\n    [cast.framework.events.EventType.PLAYER_LOAD_COMPLETE]: this._onPlayerLoadCompleteEvent\n  };\n  _castContextEventHandlers: {[event: string]: Function} = {\n    [cast.framework.system.EventType.SYSTEM_VOLUME_CHANGED]: this._onSystemVolumeChangedEvent\n  };\n\n  constructor(config: Object) {\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._eventManager = new EventManager();\n    this._player = PlayerLoader.loadPlayer(config);\n    this._tracksManager = new ReceiverTracksManager(this._player);\n    this._adsManager = new ReceiverAdsManager(this._player);\n    this._attachListeners();\n  }\n\n  getPlayer(): Object {\n    return this._player;\n  }\n\n  start(options: Object): void {\n    const defaultOptions = new cast.framework.CastReceiverOptions();\n    defaultOptions.customNamespaces = {\n      [CUSTOM_CHANNEL]: cast.framework.system.MessageType.JSON\n    };\n    Utils.Object.mergeDeep(defaultOptions, options);\n    this._logger.debug('Start receiver', defaultOptions);\n    this._context.start(defaultOptions);\n  }\n\n  onLoad(loadRequestData: Object): Promise<Object> {\n    this._logger.debug('onLoad', loadRequestData);\n    this._reset();\n    return new Promise((resovle, reject) => {\n      const mediaInfo = loadRequestData.media.customData.mediaInfo;\n      this._maybeCreateVmapAdsRequest(loadRequestData.media);\n      this._maybeReplaceAdTagTimestamp(loadRequestData.media);\n      this._eventManager.listen(this._player, this._player.Event.ERROR, event => reject(event));\n      this._eventManager.listen(this._player, this._player.Event.SOURCE_SELECTED, event => this._onSourceSelected(event, loadRequestData, resovle));\n      this._player.loadMedia(mediaInfo);\n    });\n  }\n\n  onStop(requestData: Object): Promise<Object> {\n    this._logger.debug('onStop', requestData);\n    this._destroy();\n    return requestData;\n  }\n\n  onMediaStatus(mediaStatus: Object): Promise<Object> {\n    this._logger.debug('mediaStatus', mediaStatus);\n    mediaStatus.customData = mediaStatus.customData || {};\n    if (this._player) {\n      mediaStatus.customData.mediaInfo = this._player.getMediaInfo();\n      if (this._player.isLive()) {\n        mediaStatus.currentTime = this._player.currentTime;\n        if (mediaStatus.media) {\n          mediaStatus.media.duration = this._player.duration;\n        }\n      }\n    }\n    if (mediaStatus.playerState !== this._playerManager.getPlayerState()) {\n      mediaStatus.playerState = this._playerManager.getPlayerState();\n    }\n    return mediaStatus;\n  }\n\n  _attachListeners(): void {\n    this._context.addCustomMessageListener(CUSTOM_CHANNEL, customMessage => this._onCustomMessage(customMessage));\n    Object.keys(this._playerManagerEventHandlers).forEach(event =>\n      this._playerManager.addEventListener(event, this._playerManagerEventHandlers[event].bind(this))\n    );\n    Object.keys(this._messageInterceptorsHandlers).forEach(msg =>\n      this._playerManager.setMessageInterceptor(msg, this._messageInterceptorsHandlers[msg].bind(this))\n    );\n    Object.keys(this._castContextEventHandlers).forEach(event =>\n      this._context.addEventListener(event, this._castContextEventHandlers[event].bind(this))\n    );\n  }\n\n  _reset(): void {\n    this._shouldAutoPlay = true;\n    this._firstPlay = true;\n    this._eventManager.removeAll();\n    this._player.reset();\n  }\n\n  _destroy(): void {\n    this._shouldAutoPlay = true;\n    this._firstPlay = true;\n    this._eventManager.destroy();\n    this._player.destroy();\n  }\n\n  _onSourceSelected(event: FakeEvent, loadRequestData: Object, resolve: Function): void {\n    const source = event.payload.selectedSource[0];\n    this._handleAutoPlay(loadRequestData);\n    this._handleLiveDvr(loadRequestData);\n    this._setMediaInfo(loadRequestData, source);\n    this._maybeSetDrmLicenseUrl(source);\n    resolve(loadRequestData);\n  }\n\n  _setMediaInfo(loadRequestData: Object, source: Object): void {\n    loadRequestData.media.contentId = loadRequestData.media.contentId || source.id;\n    loadRequestData.media.contentUrl = loadRequestData.media.contentUrl || source.url;\n    loadRequestData.media.contentType = loadRequestData.media.contentType || source.mimetype;\n    loadRequestData.media.streamType = this._player.isLive() ? cast.framework.messages.StreamType.LIVE : cast.framework.messages.StreamType.BUFFERED;\n    loadRequestData.media.metadata = loadRequestData.media.metadata || new cast.framework.messages.GenericMediaMetadata();\n    loadRequestData.media.metadata.title = loadRequestData.media.metadata.title || this._player.config.sources.metadata.name;\n    loadRequestData.media.metadata.subtitle = loadRequestData.media.metadata.subtitle || this._player.config.sources.metadata.description;\n    loadRequestData.media.metadata.images = loadRequestData.media.metadata.images || [{url: this._player.config.sources.poster}];\n    loadRequestData.media.hlsSegmentFormat = loadRequestData.media.hlsSegmentFormat || cast.framework.messages.HlsSegmentFormat.TS;\n    this._logger.debug('Media info has been set', loadRequestData);\n  }\n\n  _handleAutoPlay(loadRequestData: Object): void {\n    if (!loadRequestData.autoplay) {\n      this._shouldAutoPlay = false;\n      loadRequestData.autoplay = true;\n    }\n  }\n\n  _handleLiveDvr(loadRequestData: Object): void {\n    if (this._player.isDvr()) {\n      if (loadRequestData.currentTime === LIVE_EDGE) {\n        delete loadRequestData.currentTime;\n        this._logger.debug(`Live DVR will seek to live edge`);\n      }\n      // Workaround to avoid Live & Dvr seek issue\n      this._playerManager.removeSupportedMediaCommands(cast.framework.messages.Command.SEEK);\n    } else if (!this._player.isLive()) {\n      this._playerManager.addSupportedMediaCommands(cast.framework.messages.Command.SEEK);\n    }\n  }\n\n  _maybeSetDrmLicenseUrl(source: Object): void {\n    if (source.drmData) {\n      const data = source.drmData.find(data => data.scheme === DrmScheme.WIDEVINE);\n      if (data) {\n        this._playerManager.setMediaPlaybackInfoHandler((loadRequest, playbackConfig) => {\n          playbackConfig.protectionSystem = cast.framework.ContentProtection.WIDEVINE;\n          playbackConfig.licenseUrl = data.licenseUrl;\n          this._logger.debug(`Set drm license url`, playbackConfig);\n          return playbackConfig;\n        });\n      }\n    }\n  }\n\n  _onPlayEvent(): void {\n    this._logger.debug('Play event', {firstPlay: this._firstPlay});\n    if (this._firstPlay) {\n      if (this._shouldAutoPlay) {\n        this._player.play();\n      } else {\n        this._playerManager.pause();\n      }\n      this._firstPlay = false;\n    }\n  }\n\n  _onRequestPlayEvent(): void {\n    this._logger.debug('Request play event');\n    this._player.play();\n  }\n\n  _onRequestPauseEvent(): void {\n    this._logger.debug('Request pause event');\n    this._player.pause();\n  }\n\n  _onPlayerLoadCompleteEvent(): void {\n    this._player.load();\n    this._player.ready().then(() => this._tracksManager.setInitialTracks());\n  }\n\n  _onSystemVolumeChangedEvent(systemVolumeChangedEvent: Object): void {\n    const data = systemVolumeChangedEvent.data;\n    if (this._player.volume !== data.level) {\n      this._player.volume = data.level;\n    }\n    if (this._player.muted !== data.muted) {\n      this._player.muted = data.muted;\n    }\n  }\n\n  _onCustomMessage(customMessageEvent: Object): void {\n    const customMessage = customMessageEvent.data;\n    this._logger.debug('Custom message received', customMessage);\n    switch (customMessage.type) {\n      case CustomMessageType.ACTION:\n        this._handleCustomAction(customMessage);\n        break;\n      default:\n        break;\n    }\n  }\n\n  _handleCustomAction(customAction: CustomActionMessage): void {\n    switch (customAction.action) {\n      case CustomActionType.SKIP_AD:\n        this._adsManager.skipAd();\n        break;\n      default:\n        break;\n    }\n  }\n\n  _maybeCreateVmapAdsRequest(media: Object): Object {\n    if (media.customData && media.customData.vmapAdsRequest) {\n      media.vmapAdsRequest = media.customData.vmapAdsRequest;\n    }\n  }\n\n  _maybeReplaceAdTagTimestamp(media: Object): void {\n    const replaceTimestamp = adtag => {\n      if (adtag && regex.test(adtag)) {\n        const match = adtag.match(regex);\n        return adtag.replace(match[1], Date.now());\n      }\n      return adtag;\n    };\n    const regex = /correlator=(\\[timestamp\\])/;\n    if (media.breakClips) {\n      const breakClips = media.breakClips;\n      breakClips.forEach(breakClip => {\n        if (breakClip.vastAdsRequest && breakClip.vastAdsRequest.adTagUrl) {\n          breakClip.vastAdsRequest.adTagUrl = replaceTimestamp(breakClip.vastAdsRequest.adTagUrl);\n        }\n      });\n    }\n    if (media.vmapAdsRequest) {\n      media.vmapAdsRequest.adTagUrl = replaceTimestamp(media.vmapAdsRequest.adTagUrl);\n    }\n  }\n}\n\nexport {ReceiverManager};\n\n\n\n// WEBPACK FOOTER //\n// ./receiver-manager.js","// @flow\nimport {core, setup} from 'kaltura-player-js';\nimport {CastEngine} from './cast-engine';\nimport {DefaultPlayerConfig} from './default-player-config';\nimport {ReceiverError} from './error/error';\nimport {ErrorType} from './error/error-type';\n\nconst {Utils, unRegisterEngine, registerEngine, EngineType} = core;\n\nexport const CAST_MEDIA_PLAYER_TAG: string = 'cast-media-player';\nconst PLAYER_CONTAINER: string = 'kaltura-receiver-player-container';\n\nclass PlayerLoader {\n  static loadPlayer(config: Object): Object {\n    const castMediaPlayerEl = Utils.Dom.getElementsByTagName(CAST_MEDIA_PLAYER_TAG)[0];\n    if (castMediaPlayerEl) {\n      const castMediaElement = castMediaPlayerEl.getMediaElement();\n      castMediaElement.style.position = 'absolute';\n      const playerContainerEl = Utils.Dom.createElement('div');\n      playerContainerEl.id = PLAYER_CONTAINER;\n      Utils.Dom.appendChild(document.body, playerContainerEl);\n      unRegisterEngine(EngineType.HTML5);\n      registerEngine(EngineType.CAST, CastEngine);\n      const playerConfig = Utils.Object.mergeDeep({targetId: PLAYER_CONTAINER}, DefaultPlayerConfig, config);\n      const player = setup(playerConfig);\n      Utils.Dom.prependTo(playerContainerEl, castMediaElement.parentNode);\n      return player;\n    } else {\n      throw new ReceiverError(ErrorType.CAST_ELEMENT_NOT_FOUND);\n    }\n  }\n}\n\nexport {PlayerLoader};\n\n\n\n// WEBPACK FOOTER //\n// ./player-loader.js","// @flow\nimport {ReceiverManagerAPI} from './receiver-manager-api';\n\ndeclare var __VERSION__: string;\ndeclare var __NAME__: string;\n\nexport {ReceiverManagerAPI as Receiver};\nexport {__VERSION__ as VERSION, __NAME__ as NAME};\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","// @flow\nimport {ReceiverManager} from './receiver-manager';\n\nlet receiverManager;\n\nclass ReceiverManagerAPI {\n  constructor(config: Object) {\n    receiverManager = new ReceiverManager(config);\n  }\n\n  start(options?: Object = {}): void {\n    receiverManager.start(options);\n  }\n\n  onLoad(loadRequestData: Object): Promise<Object> {\n    return receiverManager.onLoad(loadRequestData);\n  }\n\n  onStop(requestData: Object): Promise<Object> {\n    return receiverManager.onStop(requestData);\n  }\n\n  onMediaStatus(mediaStatus: Object): Promise<Object> {\n    return receiverManager.onMediaStatus(mediaStatus);\n  }\n\n  addEventListener(type: string, listener: Function): void {\n    receiverManager.getPlayer().addEventListener(type, listener);\n  }\n\n  removeEventListener(type: string, listener: Function): void {\n    receiverManager.getPlayer().removeEventListener(type, listener);\n  }\n}\n\nexport {ReceiverManagerAPI};\n\n\n\n// WEBPACK FOOTER //\n// ./receiver-manager-api.js","// @flow\nimport {core} from 'kaltura-player-js';\nimport {CAST_MEDIA_PLAYER_TAG} from './player-loader';\n\nconst {Track, Utils, FakeEvent, MediaType, getLogger, FakeEventTarget, EventManager, EventType, AudioTrack, TextTrack, AbrMode, MimeType} = core;\n\nclass CastEngine extends FakeEventTarget {\n  static get id(): string {\n    return 'cast';\n  }\n\n  static canPlaySource(source: Object): boolean {\n    const mimeType = source.mimetype.toLowerCase();\n    const supported = CastEngine._supportedMimeTypes.includes(mimeType);\n    if (supported) {\n      if (source.drmData) {\n        return MimeType.DASH.includes(mimeType);\n      }\n      return true;\n    }\n    return false;\n  }\n\n  static createEngine(source: Object, config: Object): Object {\n    return new this(source, config);\n  }\n\n  static _logger: any = getLogger('CastEngine');\n\n  static _supportedMimeTypes: Array<string> = [...MimeType.HLS, ...MimeType.DASH, ...MimeType.PROGRESSIVE, ...MimeType.SMOOTH_STREAMING];\n\n  _el: HTMLVideoElement;\n  _source: Object;\n  _config: Object;\n  _eventManager: EventManager;\n  _isLoaded: boolean = false;\n  _tracks: Array<Track> = [];\n  _volume: number = 1;\n  _muted: boolean = false;\n  _paused: boolean = false;\n  _seeking: boolean = false;\n  _ended: boolean = false;\n  _mediaElementEvents: Array<string> = [\n    EventType.ABORT,\n    EventType.CAN_PLAY,\n    EventType.CAN_PLAY_THROUGH,\n    EventType.DURATION_CHANGE,\n    EventType.EMPTIED,\n    EventType.ENDED,\n    EventType.LOADED_DATA,\n    EventType.LOADED_METADATA,\n    EventType.LOAD_START,\n    EventType.PAUSE,\n    EventType.PLAY,\n    EventType.PLAYING,\n    EventType.PROGRESS,\n    EventType.RATE_CHANGE,\n    EventType.SEEKED,\n    EventType.SEEKING,\n    EventType.STALLED,\n    EventType.TIME_UPDATE,\n    EventType.SUSPEND,\n    EventType.WAITING\n  ];\n\n  constructor(source: Object, config: Object) {\n    super();\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._eventManager = new EventManager();\n    this._createVideoElement();\n    this._init(source, config);\n  }\n\n  restore(source: Object, config: Object): void {\n    this.reset();\n    this._init(source, config);\n  }\n\n  attach(): void {\n    const videoElement = this.getVideoElement();\n    this._eventManager.listen(videoElement, EventType.SEEKED, () => (this._seeking = false));\n    this._eventManager.listen(videoElement, EventType.SEEKING, () => (this._seeking = true));\n    this._eventManager.listen(videoElement, EventType.ENDED, () => {\n      this._ended = true;\n      // Receiver has a problem where the current time isn't equals to the duration when\n      // playback is ended. This prevent from analytics plugins to report 100% reached.\n      // So we're trigger time update event again on ended and take care to handle this state also in the\n      // current time setter.\n      if (!this.isLive()) {\n        this.dispatchEvent(new FakeEvent(EventType.TIME_UPDATE));\n      }\n    });\n    if (this.isLive()) {\n      this._eventManager.listen(videoElement, EventType.TIME_UPDATE, () => this._playerManager.broadcastStatus(true));\n    }\n    this._mediaElementEvents.forEach(mediaElementEvent =>\n      this._eventManager.listen(videoElement, mediaElementEvent, () => this.dispatchEvent(new FakeEvent(mediaElementEvent)))\n    );\n  }\n\n  detach(): void {\n    // Empty implementation\n  }\n\n  static runCapabilities(): void {\n    // Empty implementation\n  }\n\n  static prepareVideoElement(): void {\n    // Empty implementation\n  }\n\n  static getCapabilities(): Promise<Object> {\n    return Promise.resolve({\n      [CastEngine.id]: {\n        autoplay: true,\n        mutedAutoPlay: true\n      }\n    });\n  }\n\n  get id(): string {\n    return CastEngine.id;\n  }\n\n  getVideoElement(): HTMLVideoElement {\n    return this._el;\n  }\n\n  load(startTime: ?number): Promise<Object> {\n    CastEngine._logger.debug('Load start', startTime);\n    this._isLoaded = true;\n    this._parseTracks();\n    this.dispatchEvent(new FakeEvent(EventType.ABR_MODE_CHANGED, {mode: AbrMode.AUTO}));\n    CastEngine._logger.debug('Load end', this._tracks);\n    return Promise.resolve({tracks: this._tracks});\n  }\n\n  play(): void {\n    this._paused = false;\n  }\n\n  pause(): void {\n    this._paused = true;\n  }\n\n  hideTextTrack(): void {\n    // Empty implementation\n  }\n\n  selectTextTrack(textTrack: TextTrack): void {\n    this.dispatchEvent(new FakeEvent(EventType.TEXT_TRACK_CHANGED, {selectedTextTrack: textTrack}));\n  }\n\n  selectAudioTrack(audioTrack: AudioTrack): void {\n    this.dispatchEvent(new FakeEvent(EventType.AUDIO_TRACK_CHANGED, {selectedAudioTrack: audioTrack}));\n  }\n\n  selectVideoTrack(videoTrack: VideoTrack): void {\n    this.dispatchEvent(new FakeEvent(EventType.VIDEO_TRACK_CHANGED, {selectedVideoTrack: videoTrack}));\n  }\n\n  enableAdaptiveBitrate(): void {\n    // Empty implementation\n  }\n\n  isAdaptiveBitrateEnabled(): boolean {\n    return true;\n  }\n\n  getSelectedSource(): Object {\n    return Utils.Object.copyDeep(this._source);\n  }\n\n  isLive() {\n    return this._config.sources.type === MediaType.LIVE;\n  }\n\n  seekToLiveEdge(): void {\n    const range = this._playerManager.getLiveSeekableRange();\n    if (range) {\n      this._playerManager.seek(range.end);\n    }\n  }\n\n  getStartTimeOfDvrWindow(): number {\n    const range = this._playerManager.getLiveSeekableRange();\n    if (range) {\n      return range.start;\n    }\n    return 0;\n  }\n\n  reset(): void {\n    this._eventManager.removeAll();\n    this._tracks = [];\n    this._isLoaded = false;\n    this._paused = false;\n    this._seeking = false;\n    this._ended = false;\n  }\n\n  destroy(): void {\n    this._eventManager.destroy();\n    this._tracks = [];\n    this._isLoaded = false;\n    this._mediaElementEvents = [];\n    this._volume = 1;\n    this._muted = false;\n    this._paused = false;\n    this._seeking = false;\n    this._ended = false;\n    if (this._el) {\n      Utils.Dom.removeAttribute(this._el, 'src');\n      Utils.Dom.removeChild(this._el.parentNode, this._el);\n    }\n  }\n\n  set currentTime(value: number): void {\n    // Empty implementation\n  }\n\n  get currentTime(): number {\n    if (this.isLive()) {\n      return this._playerManager.getCurrentTimeSec() - this.getStartTimeOfDvrWindow();\n    }\n    if (this._ended) {\n      return this._playerManager.getDurationSec();\n    }\n    return this._playerManager.getCurrentTimeSec();\n  }\n\n  set muted(value: boolean): void {\n    this._muted = value;\n  }\n\n  get muted(): boolean {\n    return this._muted;\n  }\n\n  set volume(value: number): void {\n    this._volume = value;\n    this.dispatchEvent(EventType.VOLUME_CHANGE);\n  }\n\n  get volume(): number {\n    return this._volume;\n  }\n\n  get paused(): boolean {\n    return this._paused;\n  }\n\n  get seeking(): boolean {\n    return this._seeking;\n  }\n\n  get buffered(): Array<any> {\n    return [];\n  }\n\n  get duration(): number {\n    if (this.isLive()) {\n      const range = this._playerManager.getLiveSeekableRange();\n      if (range) {\n        return range.end - this.getStartTimeOfDvrWindow();\n      }\n    }\n    return this._playerManager.getDurationSec();\n  }\n\n  get src(): string {\n    return this._isLoaded ? this._source.url : '';\n  }\n\n  set playsinline(playsinline: boolean): void {\n    // Empty implementation\n  }\n\n  get playsinline(): boolean {\n    return true;\n  }\n\n  set playbackRate(playbackRate: number): void {\n    // Empty implementation\n  }\n\n  get playbackRate(): number {\n    return this._playerManager.getPlaybackRate();\n  }\n\n  get playbackRates(): Array<number> {\n    return [1];\n  }\n\n  get defaultPlaybackRate(): number {\n    return 1;\n  }\n\n  set crossOrigin(crossOrigin: ?string): void {\n    // Empty implementation\n  }\n\n  get crossOrigin(): ?string {\n    // Empty implementation\n  }\n\n  get ended(): boolean {\n    return this._ended;\n  }\n\n  _createVideoElement(): void {\n    const castMediaPlayerEl: Object = document.getElementsByTagName(CAST_MEDIA_PLAYER_TAG)[0];\n    if (castMediaPlayerEl) {\n      this._el = castMediaPlayerEl.getMediaElement();\n    }\n  }\n\n  _init(source: Object, config: Object): void {\n    this._source = source;\n    this._config = config;\n    this.attach();\n  }\n\n  _parseTracks(): void {\n    const audioTracksManager = this._playerManager.getAudioTracksManager();\n    const castAudioTracks = audioTracksManager.getTracks();\n    const audioTracks = this._parseAudioTracks(castAudioTracks);\n\n    const textTracksManager = this._playerManager.getTextTracksManager();\n    const castTextTracks = textTracksManager.getTracks();\n    const textTracks = this._parseTextTracks(castTextTracks);\n\n    this._tracks = audioTracks.concat(textTracks);\n  }\n\n  _parseTextTracks(castTextTracks: Array<Object>): Array<TextTrack> {\n    const textTracks = [];\n    castTextTracks.forEach(track => {\n      const settings: Object = {\n        id: track.trackId,\n        index: track.trackId - 1,\n        label: track.name,\n        language: track.language,\n        kind: track.subType || 'subtitles',\n        active: false\n      };\n      textTracks.push(new TextTrack(settings));\n    });\n    return textTracks;\n  }\n\n  _parseAudioTracks(castAudioTracks: Array<Object>): Array<AudioTrack> {\n    const audioTracks = [];\n    castAudioTracks.forEach(track => {\n      const settings: Object = {\n        id: track.trackId,\n        index: track.trackId - 1,\n        label: track.name,\n        language: track.language,\n        active: false\n      };\n      audioTracks.push(new AudioTrack(settings));\n    });\n    return audioTracks;\n  }\n}\n\nexport {CastEngine};\n\n\n\n// WEBPACK FOOTER //\n// ./cast-engine.js","// @flow\nimport {core} from 'kaltura-player-js';\n\nconst {StreamType, EngineType} = core;\n\nconst DefaultPlayerConfig: Object = {\n  playback: {\n    autoplay: false,\n    preload: 'none',\n    disableUserCache: true,\n    streamPriority: [\n      {\n        engine: EngineType.CAST,\n        format: StreamType.HLS\n      },\n      {\n        engine: EngineType.CAST,\n        format: StreamType.DASH\n      },\n      {\n        engine: EngineType.CAST,\n        format: StreamType.PROGRESSIVE\n      }\n    ]\n  },\n  ui: {\n    disable: true\n  }\n};\n\nexport {DefaultPlayerConfig};\n\n\n\n// WEBPACK FOOTER //\n// ./default-player-config.js","// @flow\nclass ReceiverError {\n  code: number;\n  description: string;\n\n  constructor(type: Object) {\n    this.code = type.code;\n    this.description = type.description;\n  }\n}\n\nexport {ReceiverError};\n\n\n\n// WEBPACK FOOTER //\n// ./error/error.js","// @flow\nconst ErrorType: {[type: string]: Object} = {\n  CAST_ELEMENT_NOT_FOUND: {\n    code: 100020,\n    description: \"<cast-media-element> tag isn't found in the DOM\"\n  }\n};\n\nexport {ErrorType};\n\n\n\n// WEBPACK FOOTER //\n// ./error/error-type.js","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\n\nconst {TextStyleConverter} = remote;\nconst {TrackType, getLogger} = core;\n\nclass ReceiverTracksManager {\n  _logger: any = getLogger('ReceiverTracksManager');\n  _playerManager: Object;\n  _player: Object;\n\n  constructor(player: Object) {\n    this._playerManager = cast.framework.CastReceiverContext.getInstance().getPlayerManager();\n    this._player = player;\n    this._attachListeners();\n  }\n\n  setInitialTracks(): void {\n    const mediaInfo = this._playerManager.getMediaInformation();\n    this._logger.debug('Set initial tracks', mediaInfo.customData);\n    if (mediaInfo.customData) {\n      this._setInitialAudioTrack(mediaInfo.customData.audioLanguage);\n      this._setInitialTextTrack(mediaInfo.customData.textLanguage);\n    }\n  }\n\n  _attachListeners(): void {\n    this._playerManager.addEventListener(cast.framework.events.EventType.REQUEST_EDIT_TRACKS_INFO, requestEvent => {\n      const activeTrackIds = requestEvent.requestData.activeTrackIds;\n      if (activeTrackIds) {\n        this._handleAudioTrackSelection(activeTrackIds);\n        this._handleTextTrackSelection(activeTrackIds);\n      } else {\n        const textTrackStyle = requestEvent.requestData.textTrackStyle;\n        this._handleTextStyleSelection(textTrackStyle);\n      }\n    });\n  }\n\n  _handleTextTrackSelection(activeTrackIds: Array<number>): void {\n    const textTracks = this._player.getTracks(TrackType.TEXT);\n    const activeTextTrack = textTracks.find(t => t.active);\n    const nextActiveTextTrack = textTracks.find(t => activeTrackIds.includes(t.id));\n    if (nextActiveTextTrack) {\n      this._player.selectTrack(nextActiveTextTrack);\n    } else if (activeTextTrack.language !== 'off') {\n      const offTrack = textTracks.find(t => t.language === 'off');\n      this._player.selectTrack(offTrack);\n    }\n  }\n\n  _handleAudioTrackSelection(activeTrackIds: Array<number>): void {\n    const audioTracks = this._player.getTracks(TrackType.AUDIO);\n    const activeAudioTrack = audioTracks.find(t => t.active);\n    const nextActiveAudioTrack = audioTracks.find(t => activeTrackIds.includes(t.id));\n    if (activeAudioTrack.id !== nextActiveAudioTrack.id) {\n      this._player.selectTrack(nextActiveAudioTrack);\n    }\n  }\n\n  _handleTextStyleSelection(textStyle: Object): void {\n    this._player.textStyle = TextStyleConverter.toPlayerTextStyle(textStyle);\n  }\n\n  _setInitialTextTrack(textLanguage: ?string): void {\n    const textTracksManager = this._playerManager.getTextTracksManager();\n    if (textLanguage) {\n      this._logger.debug('Set initial text track - setActiveByLanguage', textLanguage);\n      textTracksManager.setActiveByLanguage(textLanguage);\n    }\n  }\n\n  _setInitialAudioTrack(audioLanguage: ?string): void {\n    const audioTracksManager = this._playerManager.getAudioTracksManager();\n    const audioTracks = audioTracksManager.getTracks();\n    this._logger.debug('Set initial audio track', audioLanguage, audioTracks);\n    if (audioTracks.length > 0) {\n      if (audioLanguage) {\n        this._logger.debug('Set initial audio track - setActiveByLanguage', audioLanguage);\n        audioTracksManager.setActiveByLanguage(audioLanguage);\n      } else {\n        const audioTrackId = audioTracks[0].trackId;\n        const audioTrack = this._player.getTracks(TrackType.AUDIO).find(t => t.id === audioTrackId);\n        if (audioTrack) {\n          this._logger.debug('Set initial audio track - setActiveById', audioTrackId);\n          audioTracksManager.setActiveById(audioTrackId);\n          this._player.selectTrack(audioTrack);\n        }\n      }\n    }\n  }\n}\n\nexport {ReceiverTracksManager};\n\n\n\n// WEBPACK FOOTER //\n// ./receiver-tracks-manager.js","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\nimport {CUSTOM_CHANNEL} from './receiver-manager';\n\nconst {EventType, Ad, AdBreak, AdBreakType, getLogger} = core;\nconst {CustomEventMessage} = remote;\n\nclass ReceiverAdsManager {\n  _logger: any = getLogger('ReceiverAdsManager');\n  _context: Object;\n  _playerManager: Object;\n  _player: Object;\n  _adProgressIntervalId: ?number;\n  _ad: ?Ad;\n  _adBreak: ?AdBreak;\n  _adIsPlaying: boolean;\n  _adCanSkipTriggered: false;\n  _adLifecycleEventHandlers: {[event: string]: Function};\n  _adTrackingEventHandlers: {[event: string]: Function};\n  _playerEventHandlers: {[event: string]: Function};\n  _timePercentEvent: {[time: string]: boolean} = {\n    AD_REACHED_25_PERCENT: false,\n    AD_REACHED_50_PERCENT: false,\n    AD_REACHED_75_PERCENT: false\n  };\n\n  constructor(player: Object) {\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._player = player;\n    this._bindMethods();\n    this._attachListeners();\n  }\n\n  skipAd(): void {\n    this._logger.debug('Skip ad');\n    const requestData = new cast.framework.messages.RequestData(cast.framework.messages.MessageType.SKIP_AD);\n    this._playerManager.sendLocalMediaRequest(requestData);\n  }\n\n  _bindMethods(): void {\n    this._onPlayerLoadComplete = this._onPlayerLoadComplete.bind(this);\n    this._onBreakStarted = this._onBreakStarted.bind(this);\n    this._onBreakEnded = this._onBreakEnded.bind(this);\n    this._onBreakClipLoading = this._onBreakClipLoading.bind(this);\n    this._onBreakClipStarted = this._onBreakClipStarted.bind(this);\n    this._onBreakClipEnded = this._onBreakClipEnded.bind(this);\n    this._onAdPaused = this._onAdPaused.bind(this);\n    this._onAdResumed = this._onAdResumed.bind(this);\n    this._onAdProgress = this._onAdProgress.bind(this);\n    this._onMuteChange = this._onMuteChange.bind(this);\n    this._onVolumeChange = this._onVolumeChange.bind(this);\n  }\n\n  _attachListeners(): void {\n    this._adLifecycleEventHandlers = {\n      [cast.framework.events.EventType.PLAYER_LOAD_COMPLETE]: this._onPlayerLoadComplete,\n      [cast.framework.events.EventType.BREAK_STARTED]: this._onBreakStarted,\n      [cast.framework.events.EventType.BREAK_ENDED]: this._onBreakEnded,\n      [cast.framework.events.EventType.BREAK_CLIP_LOADING]: this._onBreakClipLoading,\n      [cast.framework.events.EventType.BREAK_CLIP_STARTED]: this._onBreakClipStarted,\n      [cast.framework.events.EventType.BREAK_CLIP_ENDED]: this._onBreakClipEnded\n    };\n    this._adTrackingEventHandlers = {\n      [cast.framework.events.EventType.PAUSE]: this._onAdPaused,\n      [cast.framework.events.EventType.PLAY]: this._onAdResumed\n    };\n    this._playerEventHandlers = {\n      [EventType.MUTE_CHANGE]: this._onMuteChange,\n      [EventType.VOLUME_CHANGE]: this._onVolumeChange\n    };\n    Object.keys(this._adLifecycleEventHandlers).forEach(event => this._playerManager.addEventListener(event, this._adLifecycleEventHandlers[event]));\n  }\n\n  _onPlayerLoadComplete(): void {\n    const positions = [];\n    const breakManager = this._playerManager.getBreakManager();\n    if (breakManager) {\n      const breaks = breakManager.getBreaks();\n      if (breaks && breaks.length > 0) {\n        breaks.forEach(b => positions.push(b.position));\n        this._sendEventAndCustomMessage(this._player.Event.AD_MANIFEST_LOADED, {adBreaksPosition: positions});\n      }\n    }\n  }\n\n  _onBreakStarted(breaksEvent: Object): void {\n    this._toggleAdBreakListeners(true);\n    const adBreakOptions = this._getAdBreakOptions(breaksEvent);\n    const adBreak = new AdBreak(adBreakOptions);\n    this._sendEventAndCustomMessage(this._player.Event.AD_BREAK_START, {adBreak: adBreak});\n    this._adBreak = adBreak;\n  }\n\n  _onBreakEnded(breaksEvent: Object): void {\n    this._toggleAdBreakListeners(false);\n    this._sendEventAndCustomMessage(this._player.Event.AD_BREAK_END);\n    this._adBreak = null;\n    const breaks = this._playerManager.getBreakManager().getBreaks();\n    const index = breaks.findIndex(b => b.id === breaksEvent.breakId);\n    if (index + 1 === breaks.length) {\n      this._sendEventAndCustomMessage(this._player.Event.ALL_ADS_COMPLETED);\n    }\n  }\n\n  _onBreakClipLoading(breaksEvent: Object): void {\n    const adOptions = this._getAdOptions(breaksEvent);\n    const ad = new Ad(breaksEvent.breakClipId, adOptions);\n    this._sendEventAndCustomMessage(this._player.Event.AD_LOADED, {ad: ad});\n    this._ad = ad;\n  }\n\n  _onBreakClipStarted(): void {\n    this._sendEventAndCustomMessage(this._player.Event.AD_STARTED);\n    this._adIsPlaying = true;\n  }\n\n  _onBreakClipEnded(): void {\n    this._sendEventAndCustomMessage(this._player.Event.AD_COMPLETED);\n    this._adIsPlaying = false;\n    this._adCanSkipTriggered = false;\n    this._ad = null;\n  }\n\n  _onAdPaused(): void {\n    this._sendEventAndCustomMessage(this._player.Event.AD_PAUSED);\n    this._adIsPlaying = false;\n  }\n\n  _onAdResumed(): void {\n    this._sendEventAndCustomMessage(this._player.Event.AD_RESUMED);\n    this._adIsPlaying = true;\n  }\n\n  _onAdProgress(): void {\n    if (!this._ad) return;\n    const adDuration = this._playerManager.getBreakClipDurationSec();\n    const adCurrentTime = this._playerManager.getBreakClipCurrentTimeSec();\n    const percent = adCurrentTime / adDuration;\n    if (!this._timePercentEvent.AD_REACHED_25_PERCENT && percent >= 0.25) {\n      this._timePercentEvent.AD_REACHED_25_PERCENT = true;\n      this._sendEventAndCustomMessage(this._player.Event.AD_FIRST_QUARTILE);\n    }\n    if (!this._timePercentEvent.AD_REACHED_50_PERCENT && percent >= 0.5) {\n      this._timePercentEvent.AD_REACHED_50_PERCENT = true;\n      this._sendEventAndCustomMessage(this._player.Event.AD_MIDPOINT);\n    }\n    if (!this._timePercentEvent.AD_REACHED_75_PERCENT && percent >= 0.75) {\n      this._timePercentEvent.AD_REACHED_75_PERCENT = true;\n      this._sendEventAndCustomMessage(this._player.Event.AD_THIRD_QUARTILE);\n    }\n    if (!this._adCanSkipTriggered && this._ad.skippable) {\n      if (adCurrentTime >= this._ad.skipOffset) {\n        this._sendEventAndCustomMessage(this._player.Event.AD_CAN_SKIP);\n        this._adCanSkipTriggered = true;\n      }\n    }\n    this._sendEventAndCustomMessage(this._player.Event.AD_PROGRESS, {\n      adProgress: {\n        currentTime: adCurrentTime,\n        duration: adDuration\n      }\n    });\n  }\n\n  _onMuteChange(): void {\n    if (this._player.muted) {\n      this._sendEventAndCustomMessage(this._player.Event.AD_MUTED);\n    }\n  }\n\n  _onVolumeChange(): void {\n    this._sendEventAndCustomMessage(this._player.Event.AD_VOLUME_CHANGED);\n  }\n\n  _toggleAdBreakListeners(toggle: boolean): void {\n    if (toggle) {\n      Object.keys(this._adTrackingEventHandlers).forEach(event => this._playerManager.addEventListener(event, this._adTrackingEventHandlers[event]));\n      Object.keys(this._playerEventHandlers).forEach(event => this._player.addEventListener(event, this._playerEventHandlers[event]));\n      this._adProgressIntervalId = setInterval(this._onAdProgress, 300);\n    } else {\n      Object.keys(this._adTrackingEventHandlers).forEach(event =>\n        this._playerManager.removeEventListener(event, this._adTrackingEventHandlers[event])\n      );\n      Object.keys(this._playerEventHandlers).forEach(event => this._player.removeEventListener(event, this._playerEventHandlers[event]));\n      clearInterval(this._adProgressIntervalId);\n      this._adProgressIntervalId = null;\n    }\n  }\n\n  _getAdBreakOptions(breaksEvent: Object): void {\n    const options = {};\n    const currentBreak = this._playerManager.getBreakManager().getBreakById(breaksEvent.breakId);\n    if (currentBreak) {\n      options.position = currentBreak.position;\n      options.type = this._getAdBreakTypeByPosition(currentBreak.position);\n      options.numAds = currentBreak.breakClipIds.length;\n    }\n    return options;\n  }\n\n  _getAdBreakTypeByPosition(position: number): void {\n    switch (position) {\n      case 0:\n        return AdBreakType.PRE;\n      case -1:\n        return AdBreakType.POST;\n      default:\n        return AdBreakType.MID;\n    }\n  }\n\n  _getAdOptions(breaksEvent: Object): void {\n    const options = {};\n    const currentBreak = this._playerManager.getBreakManager().getBreakById(breaksEvent.breakId);\n    const currentBreakClip = this._playerManager.getBreakManager().getBreakClipById(breaksEvent.breakClipId);\n    options.url = currentBreakClip.contentId;\n    options.contentType = currentBreakClip.contentType;\n    options.title = currentBreakClip.title;\n    options.position = currentBreak.breakClipIds.indexOf(currentBreakClip.id) + 1;\n    options.duration = currentBreakClip.duration;\n    options.clickThroughUrl = currentBreakClip.clickThroughUrl;\n    options.posterUrl = currentBreakClip.posterUrl;\n    options.skipOffset = currentBreakClip.whenSkippable;\n    options.linear = true;\n    return options;\n  }\n\n  _sendEventAndCustomMessage(event: string, payload: any): void {\n    this._logger.debug(event.toUpperCase(), payload);\n    this._player.dispatchEvent(event, payload);\n    this._context.sendCustomMessage(CUSTOM_CHANNEL, undefined, new CustomEventMessage(event, payload));\n  }\n}\n\nexport {ReceiverAdsManager};\n\n\n\n// WEBPACK FOOTER //\n// ./receiver-ads-manager.js"],"sourceRoot":""}